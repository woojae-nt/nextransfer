<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="common">   

    <select id="selectDate" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		select to_char(sysdate,'yyyy')      n_year
		     , to_char(sysdate,'yyyymmdd')  n_date
		     , to_char(sysdate,'yyyy.mm.dd')	n_date_fm1
		  from dual   
    </select>
    
    <select id="selectComnList" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		select l_code
			 , s_code
			 , l_code_nm
			 , s_code_nm
		  from tb_common_l a 
		 where l_code>' '
           <if test="l_code != null and l_code != ''">
		   and l_code = #{l_code}
           </if>
           <if test="l_code_list != null and l_code_list != ''">
		   and l_code in (${l_code_list})
           </if>
           <if test="s_code != null and s_code != ''">
		   and s_code like '%'||#{s_code}||'%'
           </if>
           <if test="s_code_list != null and s_code_list != ''">
		   and s_code in (${s_code_list})
           </if>
		   and use_yn = 'Y'
         order by l_code,s_code 
    </select>
    
    <select id="selectDocListTxt" parameterType="java.util.HashMap" resultType="java.lang.String">
		select case when assoc03 in('1','2','3') and assoc04 = '2' then '1,6'
		            when assoc03 in('1','2','3') and assoc04 != '2' then '2,3,4,6,7'
		            when assoc03 in('4','5','6') then '5,6'
		            else '1,2,3,4,5,6,7'
		       end doc_code
		  from (
		        select substr(assoc_cd_new,4,1) assoc03     -- 공모(1,2,3), 사모(4,5,6)
		             , substr(assoc_cd_new,5,1) assoc04     -- 일반(1), 모펀드(2), 자펀드(3)
		          from tb_fund_m
		         where fund_cd = #{fund_cd}
		       )   
    </select>
    
    <insert id="updateLog" parameterType="java.util.HashMap" >
		INSERT INTO TB_LOG_L 
		       ( 
		           LOG_DATE,
		           SEQ_NO,
		           W_ID,
		           EXEC_SQL,
		           REG_ID,
		           REG_DATE 
		       ) 
		       VALUES 
		       ( 
		           TO_CHAR(SYSDATE, 'YYYYMMDD'), 
		           LOG_SEQ.NEXTVAL,
		           ${w_id}, 
		           ${exec_sql}, 
		           ${user_id},
		           SYSDATE 
		       ) 
    </insert>
</mapper> 
